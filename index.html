<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ultra Advanced Music Website</title>
  <meta name="description" content="A futuristic, ultra-advanced music website with vibrant colors, animations, and an advanced music player.">
  <meta name="author" content="Varun Prasath">
  <style>
    /* Vibrant Color Theme */
    :root {
      --primary-color: #FF2D95;
      --secondary-color: #2DFEFF;
      --accent-color: #FFDA2D;
      --bg-dark: #1a1a1a;
      --bg-darker: #121212;
      --text-light: #ffffff;
      --border-radius: 8px;
      --transition-speed: 0.3s;
      --shadow: 0px 5px 15px rgba(0, 0, 0, 0.5);
    }
    /* Basic Global Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-dark);
      color: var(--text-light);
      overflow-x: hidden;
    }
    header {
      background: var(--primary-color);
      padding: 1rem;
      text-align: center;
      font-size: 2rem;
      font-weight: bold;
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    /* Navigation */
    nav ul {
      list-style: none;
      display: flex;
      justify-content: center;
      gap: 1rem;
    }
    nav a {
      color: var(--text-light);
      text-decoration: none;
      font-weight: bold;
      transition: color var(--transition-speed);
    }
    nav a:hover {
      color: var(--accent-color);
    }
  </style>
  <style>
    .hero {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      background-size: 200% 200%;
      animation: gradientFlow 10s ease infinite;
      padding: 4rem 2rem;
      text-align: center;
    }
    @keyframes gradientFlow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    /* Rotating Cube Styles */
    #cube-container {
      width: 120px;
      height: 120px;
      margin: 30px auto;
      perspective: 600px;
    }
    .cube {
      width: 120px;
      height: 120px;
      position: relative;
      transform-style: preserve-3d;
      animation: rotateCube 10s infinite linear;
    }
    .face {
      position: absolute;
      width: 120px;
      height: 120px;
      border: 2px solid var(--primary-color);
      background: var(--secondary-color);
      box-shadow: inset 0 0 10px rgba(0,0,0,0.7);
    }
    .front  { transform: translateZ(60px); }
    .back   { transform: rotateY(180deg) translateZ(60px); }
    .right  { transform: rotateY(90deg) translateZ(60px); }
    .left   { transform: rotateY(-90deg) translateZ(60px); }
    .top    { transform: rotateX(90deg) translateZ(60px); }
    .bottom { transform: rotateX(-90deg) translateZ(60px); }
    @keyframes rotateCube {
      0%   { transform: rotateX(0deg) rotateY(0deg); }
      50%  { transform: rotateX(180deg) rotateY(180deg); }
      100% { transform: rotateX(360deg) rotateY(360deg); }
    }
  </style>
</head>
<body>
  <header>
    <nav>
      <ul>
        <li>
          <a href="#home">Home</a>
        </li>
        <li>
          <a href="#about">About</a>
        </li>
        <li>
          <a href="#music">Music</a>
        </li>
      </ul>
    </nav>
  </header>
  <section id="home" class="hero">
    <h2>Welcome to the Future of Music</h2>
    <p>Experience vibrant colors, dynamic animations, and an ultra-advanced music player.</p>
    <div id="cube-container">
      <div class="cube">
        <div class="face front"></div>
        <div class="face back"></div>
        <div class="face right"></div>
        <div class="face left"></div>
        <div class="face top"></div>
        <div class="face bottom"></div>
      </div>
    </div>
  </section>
  <section id="music">
  <h2>Music Player</h2>
  <div class="music-player">
    <canvas id="visualizer"></canvas>
    
    <audio id="audio-player">
      <source src="https://varun1210163.github.io/music/song1.mp3" type="audio/mpeg">
      Your browser does not support audio.
    </audio>

    <div class="controls">
      <button id="prev">‚èÆÔ∏è</button>
      <button id="play">‚ñ∂Ô∏è</button>
      <button id="pause">‚è∏Ô∏è</button>
      <button id="next">‚è≠Ô∏è</button>
      <button id="loop">üîÅ Loop Off</button>
    </div>

    <div class="progress-container" id="progress-container">
      <div class="progress" id="progress"></div>
    </div>
    <div id="time-display">0:00 / 0:00</div>

    <div class="volume-container">
      <label for="volume">Volume:</label>
      <input type="range" id="volume" min="0" max="1" step="0.01" value="1">
    </div>
  </div> <!-- üéµ End of .music-player -->

  <!-- üéµ Playlist Manager -->
  <div class="playlist-container">
    <h3>Create & Manage Playlists</h3>
    <input type="text" id="playlist-name" placeholder="Enter Playlist Name">
    <button id="create-playlist">‚ûï Create Playlist</button>
    <select id="playlist-selector"></select>
    <button id="rename-playlist">‚úèÔ∏è Rename</button>
  </div>

  <!-- Search Box for Filtering Songs -->
  <div class="search-container" style="text-align:center; margin-top:1rem;">
    <input type="text" id="search-box" oninput="searchSongs()" placeholder="Search Songs..."
      style="padding: 0.5rem; border-radius: var(--border-radius); border: 1px solid #ccc;">
  </div>

  <!-- üé∂ Available Songs -->
  <h3>Available Songs</h3>
  <ul class="playlist" id="available-songs">
    <li data-src="https://varun1210163.github.io/music/song1.mp3" data-type="audio">
      Refreshing music of Doraemon 
      <button class="add-to-playlist">‚ûï</button>
    </li>
    <li data-src="https://varun1210163.github.io/music/song2.mp3" data-type="audio">
      Doraemon Explorer Bow Bow BGM 
      <button class="add-to-playlist">‚ûï</button>
    </li>
  </ul>

  <!-- üéµ User Playlist (Supports Multiple Playlists) -->
  <h3>Current Playlist: <span id="current-playlist-name">None</span></h3>
  <ul class="user-playlist" id="user-playlist"></ul>

</section> <!-- üîö End of Music Section -->
  <footer>
    <p>¬© 2025 Ultra Advanced Music Website. All Rights Reserved.</p>
  </footer>
<script>
  let db;
  const request = indexedDB.open("MusicPlaylists", 1);

  request.onupgradeneeded = function (event) {
    db = event.target.result;
    if (!db.objectStoreNames.contains("playlists")) {
      db.createObjectStore("playlists", { keyPath: "name" });
    }
  };

  request.onsuccess = function (event) {
    db = event.target.result;
    loadPlaylists();
  };

  request.onerror = function (event) {
    console.error("IndexedDB error:", event.target.error);
  };

  function savePlaylist(name, songs) {
    const transaction = db.transaction(["playlists"], "readwrite");
    const store = transaction.objectStore("playlists");
    store.put({ name, songs });
  }

  function loadPlaylists() {
    const transaction = db.transaction(["playlists"], "readonly");
    const store = transaction.objectStore("playlists");
    const request = store.getAll();

    request.onsuccess = function (event) {
      const playlists = event.target.result;
      playlistSelector.innerHTML = "";
      playlists.forEach((playlist) => {
        const option = document.createElement("option");
        option.value = playlist.name;
        option.textContent = playlist.name;
        playlistSelector.appendChild(option);
      });
      updatePlaylistUI();
    };
  }

  function updatePlaylistUI() {
    userPlaylist.innerHTML = "";
    const currentPlaylist = playlistSelector.value;
    currentPlaylistName.textContent = currentPlaylist || "None";

    if (!currentPlaylist) return;

    const transaction = db.transaction(["playlists"], "readonly");
    const store = transaction.objectStore("playlists");
    const request = store.get(currentPlaylist);

    request.onsuccess = function (event) {
      const playlist = event.target.result;
      if (playlist && playlist.songs.length > 0) {
        playlist.songs.forEach((song, index) => {
          const li = document.createElement("li");
          li.textContent = song.name;
          li.setAttribute("data-src", song.src);
          li.draggable = true;
          li.classList.add("draggable");

          // Remove Button
          const removeBtn = document.createElement("button");
          removeBtn.textContent = "‚ùå";
          removeBtn.onclick = function () {
            playlist.songs.splice(index, 1);
            savePlaylist(currentPlaylist, playlist.songs);
            updatePlaylistUI();
          };

          li.appendChild(removeBtn);
          userPlaylist.appendChild(li);
        });

        enableDragAndDrop();
      }
    };
  }

  function renamePlaylist() {
    const oldName = playlistSelector.value;
    if (!oldName) return alert("Select a playlist to rename.");

    const newName = prompt("Enter new playlist name:", oldName);
    if (!newName || newName === oldName) return;

    const transaction = db.transaction(["playlists"], "readwrite");
    const store = transaction.objectStore("playlists");
    const getRequest = store.get(oldName);

    getRequest.onsuccess = function (event) {
      const playlist = event.target.result;
      if (playlist) {
        store.delete(oldName);  // ‚úÖ Corrected: Delete only after successfully saving the new one
        const newTransaction = db.transaction(["playlists"], "readwrite");
        const newStore = newTransaction.objectStore("playlists");
        newStore.put({ name: newName, songs: playlist.songs });

        newTransaction.oncomplete = function () {
          loadPlaylists();
          alert("Playlist renamed successfully!");
        };
      }
    };
  }

  document.getElementById("rename-playlist").addEventListener("click", renamePlaylist);

  function enableDragAndDrop() {
    const items = document.querySelectorAll(".user-playlist li");
    items.forEach((item) => {
      item.addEventListener("dragstart", dragStart);
      item.addEventListener("dragover", dragOver);
      item.addEventListener("drop", dropItem);
      item.addEventListener("dragend", dragEnd);
    });
  }

  let draggedItem = null;

  function dragStart(e) {
    draggedItem = this;
    e.dataTransfer.effectAllowed = "move";
    e.dataTransfer.setData("text", this.innerHTML);
    this.classList.add("dragging");
  }

  function dragOver(e) {
    e.preventDefault();
  }

  function dropItem(e) {
    e.preventDefault();
    if (draggedItem !== this) {
      let tempSrc = this.getAttribute("data-src");
      let tempText = this.textContent;

      this.setAttribute("data-src", draggedItem.getAttribute("data-src"));
      this.textContent = draggedItem.textContent;
      draggedItem.setAttribute("data-src", tempSrc);
      draggedItem.textContent = tempText;
    }
  }

  function dragEnd() {
    this.classList.remove("dragging");
  }

  document.addEventListener("DOMContentLoaded", function () {
    const addPlaylistButtons = document.querySelectorAll(".add-to-playlist");

    addPlaylistButtons.forEach((button) => {
      button.addEventListener("click", function () {
        const songElement = button.parentElement;
        const songName = songElement.textContent.replace("‚ûï", "").trim();
        const songSrc = songElement.getAttribute("data-src");

        const currentPlaylist = playlistSelector.value;
        if (!currentPlaylist) {
          alert("Please select a playlist first!");
          return;
        }

        const transaction = db.transaction(["playlists"], "readwrite");
        const store = transaction.objectStore("playlists");
        const getRequest = store.get(currentPlaylist);

        getRequest.onsuccess = function (event) {
          let playlist = event.target.result;
          if (!playlist) {
            playlist = { name: currentPlaylist, songs: [] };
          }

          if (!playlist.songs.some((song) => song.src === songSrc)) {
            playlist.songs.push({ name: songName, src: songSrc });
            store.put(playlist);
            updatePlaylistUI();
          }
        };
      });
    });
  });

  document.getElementById("create-playlist").addEventListener("click", function () {
    const name = playlistNameInput.value.trim();
    if (!name) return alert("Enter a playlist name!");

    const transaction = db.transaction(["playlists"], "readwrite");
    const store = transaction.objectStore("playlists");
    const getRequest = store.get(name);

    getRequest.onsuccess = function (event) {
      if (!event.target.result) {
        store.put({ name, songs: [] });
        playlistNameInput.value = "";
        loadPlaylists();
      } else {
        alert("Playlist name already exists!");
      }
    };
  });

  playlistSelector.addEventListener("change", updatePlaylistUI);
</script>
